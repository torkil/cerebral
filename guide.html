<html>
<head>

  <title></title>

  <link rel="stylesheet" type="text/css" href="style/main.css">
  <link rel="stylesheet" type="text/css" href="style/github-highlight.css">

  <script type="text/javascript" src="./js/rainbow-min.js"></script>

  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-33922998-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>
<body>

  <header>
    <nav>
      <ul>
        <li class="end"><a href="https://github.com/gorillatron/cerebral">github</a></li>
        <li>API Reference</li>
        <li class="active">Guide</li>
        <li> <a href="./index.html">Home</a></li>
      </ul>
    </nav>
  </header>

  

  <section id="content" class="guide">

    <section id="preface">
      <h1>Requirements and dependencies</h1>
      <p>
        Cerebral depends on and utelizes the following libraries; requirejs, backbone, underscore/lo-dash and jQuery. 
      </p>
      <p>
        For now these are requirements. In future development we will try to make it work with a more lightweight module loader like almond, 
        and be DOM library agnostic so you can use zepto, ender or any other library if choice for DOM manipulation.
      </p>

      <h3>Disclaimer</h3>
      <p>
        Understanding of backbone and amd loaders like requirejs needed.
      </p>
      <p>
        All APIs er subject to change.
      </p>
    </section>

    <section id="getting-started">
      <h1>Getting started</h1>
      <p>
        First we set up requirejs so cerebral knows where to look for backbone, underscore and jquery.
      </p>
<pre>
<code data-language="html">
  &lt;script type="text/javascript" src="cerebral/vendor/require.js"></script>

  &lt;script type="text/javascript">
      require.config({
        baseUrl: "js/",
        shim: {
          "backbone": {
            deps: ["underscore", "jquery"],
            exports: "Backbone"
          },
          "underscore": {
            exports: "_"
          },
        },
        paths: {
          "backbone": "cerebral/vendor/backbone",
          "underscore": "cerebral/vendor/underscore",
          "jquery": "cerebral/vendor/jquery"
        }
      })
  &lt;/script>
</code>
</pre>
    
    <h2>Setting up the app</h2>
    <p>
      Now we include the main javascript file of our application, this will use the cerebral/application/core to load its modules.
    </p>

<pre>
<code data-language="html">
  &lt;script type="text/javascript" src="js/app.js"></script>
</code>
</pre>
    
      <h3>app.js</h3>
      <p>
        In app.js we configure the core so it knows where to look for modules and start them up. More on what happens when you start and stop modules after the code.
      </p>

<pre>
<code data-language="js">
require([ "cerebral/application/core" ], function( core ){
  
  var app = Object.create( core )

  app.configure({
    moduleRoot: 'modules/'
  })

  app.start("chat", {
    element: '#chat'
  })

  app.start("log", {
    element: '#log'
  })

})
</code>
</pre>
      
      <p>
        When core starts the module named chat it will look for its main file under the module root you specified when you configures the core, so in our case
        it will look for it under 'js/modules/chat/main.js'.
      </p>

      <p>
        It will use requirejs to load the modules main file and check that it either returns a function or an object containing a main method. Here is and example
        of a module main file.
      </p>  
<pre>
<code data-language="js">
//inside chat/main.js
define([ "chat/sandbox" ], function( sandbox ){
  
  function main() {
    console.log( "started chat" )
  }

  return main
})
</code>
</pre>

      <p>
        You might allso notice that when we started our modules we gave an object as our second parameter containing a element with a string css selector as a value. This will be used to
        tell the modules sandbox what element on the pace it has access to.
      </p>

      <h2>Sandbox</h2>
      <p>
        When the chat module is loaded it is defined a namespace using requirejs where the chat modules sandbox is located. This sandbox will contain the element the module is assigned,
        a scoped jQuery/DOM manipulation function that only has access to elements within the module element and other properties you specify on the sandboxfactory.
      </p>

<pre>
<code data-language="js">
//inside chat/main.js
define([ "chat/sandbox" ], function( sandbox ){

  function main() {
    
    sandbox.element[ 0 ] === $('#chat')[ 0 ] 
    true

    sandbox.$( '#other-module' ).length === 0   
    true

  }
  ...
</code>
</pre>

      <h3>Modifying sandbox properties</h3>
      <p>
        We want to make a logging function on our sandbox so we can easily swap the logging mechanics at a later time or even do additional stuff like log to the server via ajax.
      </p>

<pre>
<code data-language="js">
require([ "cerebral/application/core", "cerebral/application/sandboxfactory" ], function( core, sandboxfactory ){
  
  var app = Object.create( core )

  sandboxfactory.defineProperty("log", function( msg ) {
    if( window.console && console.log )
      console.log( msg )
  })

  app.configure({...
</code>
</pre>

    </section>

  </section>




  <footer>
    <div class="credits">
      Built by Andre Tangen <span class="gorillatron"><a href="https://twitter.com/gorillatron">@gorillatron</a></span> and <span class="wtw"><img src="style/gfx/wtw3.png"></span>
    </div>
  </footer>

</body>
</html>